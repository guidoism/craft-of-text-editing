In this one we are basically just doing exactly what The Craft of Text
Editing says to do, in that order.

** Buffers (and the World)

#+begin_src zig :tangle build/editor.zig
const std = @import("std");

const FileNameMax = 64; 
const BufferNameMax = 64;
const ModeNameMax = 64;

const Status = enum {
    ok,
    failed,
};

const World = struct {
    buffer_chain: ?*Buffer,
    current_buffer: ?*Buffer,

    pub fn init() Status {
        _ = Buffer.create("*scratch*");
        //world.current_buffer = 
        return Status.ok;
    }

    fn fini() Status {
    }

    fn save(filename: []u8) Status {
        std.debug.print("TODO: {}\n", .{filename});
    }

    fn load(filename: []u8) Status {
        std.debug.print("TODO: {}\n", .{filename});
    }
};

var world = World{.buffer_chain=undefined, .current_buffer=undefined};

const Buffer = struct {
    next_chain_entry: ?*Buffer = undefined,
    name: [BufferNameMax]u8 = undefined,

    point: Location,
    cur_line: u32 = 0,
    num_chars: u32 = 0,
    num_lines: u32 = 0,

    mark_list: ?*Mark = undefined,
    contents: ?*Storage = undefined,

    file_name: [FileNameMax]u8 = undefined,
    file_time: Time = undefined,
    is_modified: bool = false,

    mode_list: ?*Mode = undefined,

    fn create(name: []const u8) Status {
        var buf = Buffer{.point=Location{}};
        std.mem.copy(buf.name, name);
        return Status.ok;
    }
    
    fn clear(name: []u8) Status {
        std.debug.print("TODO: {}\n", .{name});
    }
    
    fn delete(name: []u8) Status {
        std.debug.print("TODO: {}\n", .{name});
    }
    
    fn setCurrent(name: []u8) Status {
        std.debug.print("TODO: {}\n", .{name});
    }
    
    fn setNext() []u8 {
    }
    
    fn setName(name: []u8) Status {
        std.debug.print("TODO: {}\n", .{name});
    }
    
    fn getName() []u8 {
    }
    
};

const Location = struct {
    i: u32 = 0,
};

const Mark = struct {
    next_mark: ?*Mark,
    name: ?*MarkName,
    where_it_is: Location,
    is_fixed: bool,
};

const Mode = struct {
    next_mode: ?*Mode,
    mode_name: [ModeNameMax]u8,
    add_proc: *const fn () Status,
};

const Storage = struct {};
const MarkName = struct {};
const Time = struct {};

pub fn main() void {
    var status = World.init();
    _ = status;
}

#+end_src
